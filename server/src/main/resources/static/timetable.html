<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planner - ScheduleLynx</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="planner-page">
<!-- Navigation Bar (kept visible so user can exit planner) -->
<nav class="navbar">
    <div class="nav-container">
        <div class="logo">
            <h1>ScheduleLynx</h1>
        </div>
        <ul class="nav-menu">
            <li><a href="home.html" class="nav-link">Home</a></li>
            <li><a href="index.html" class="nav-link">Dashboard</a></li>
            <li><a href="timetable.html" class="nav-link active">Planner</a></li>
            <li><a href="features.html" class="nav-link">Features</a></li>
            <li><a href="#" onclick="logout()" class="nav-link logout-link">Logout</a></li>
        </ul>
    </div>
</nav>

<div class="planner-container container">
    <aside class="sidebar">
        <section class="panel">

            <h2>Add / Edit Task</h2>
            <form id="timetableForm" class="task-form">

                <div id="titleGroup" class="form-group">
                    <label for="titleInput">Title</label>
                    <input id="titleInput" name="title" type="text" placeholder="e.g., EECS lab" required/>
                </div>

                <div id="typeGroup" class="form-group">
                    <label for="typeInput">Type</label>
                    <select id="typeInput" name="type">
                        <option value="task">Task</option>
                        <option value="event">Event</option>
                    </select>
                </div>

                <div id="dateGroup" class="form-group">
                    <label for="dateInput">Date (dueDate)</label>
                    <input id="dateInput" name="date" type="date" required/>
                </div>

                <div id="startTimeGroup" class="form-group" style="display:none;">
                    <label for="startTimeInput">Start Time</label>
                    <input id="startTimeInput" name="startTime" type="time"/>
                </div>

                <div id="endTimeGroup" class="form-group" style="display:none;">
                    <label for="endTimeInput">End Time</label>
                    <input id="endTimeInput" name="endTime" type="time"/>
                </div>

                <div id="estHoursGroup" class="form-group">
                    <label for="estHoursInput">Estimated Hours</label>
                    <input id="estHoursInput" name="estHours" type="number" min="0" step="0.5" value="1" required/>
                </div>

                <div id="descGroup" class="form-group">
                    <label for="descInput">Description</label>
                    <textarea id="descInput" name="desc" placeholder="Optional details..."></textarea>
                </div>

                <div id="recurGroup" class="form-group">
                    <label><input id="isRecurInput" name="isRecur" type="checkbox"/> Recurring</label>
                </div>

                <div id="recurrenceOptions" style="display:none;">
                    <div class="form-group">
                        <label for="recurrenceType">Recurrence</label>
                        <select id="recurrenceType" name="recurType">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="biweekly">Biweekly</option>
                        </select>
                    </div>

                    <div id="daysOfWeekGroup" class="form-group days-checkbox" style="display:none;">
                        <label><input name="isMon" type="checkbox" value="Mon"/> Mon</label>
                        <label><input name="isTue" type="checkbox" value="Tue"/> Tue</label>
                        <label><input name="isWed" type="checkbox" value="Wed"/> Wed</label>
                        <label><input name="isThu" type="checkbox" value="Thu"/> Thu</label>
                        <label><input name="isFri" type="checkbox" value="Fri"/> Fri</label>
                        <label><input name="isSat" type="checkbox" value="Sat"/> Sat</label>
                        <label><input name="isSun" type="checkbox" value="Sun"/> Sun</label>
                    </div>

                    <div class="form-group">
                        <label for="recurrenceEnd">Recurrence End Date</label>
                        <input id="recurrenceEnd" name="recurEnd" type="date"/>
                    </div>
                </div>

                <div class="form-buttons">
                    <button class="btn-primary" type="submit">Save Task</button>
                    <button class="btn-secondary" id="clearForm" type="button"
                            onclick="document.getElementById('taskForm').reset();
                            document.getElementById('recurrenceOptions').style.display='none';
                            document.getElementById('startTimeGroup').style.display='none';
                            document.getElementById('endTimeGroup').style.display='none';">
                        Reset
                    </button>
                </div>
            </form>
        </section>
    </aside>

    <main class="main-content">
        <div class="controls">
            <div class="control-buttons">
                <button class="btn-nav" id="prevWeek">◀ Prev</button>
                <div class="week-display" id="weekDisplay">Week</div>
                <button class="btn-nav" id="nextWeek">Next ▶</button>
            </div>
            <div class="control-actions">
                <button class="btn-primary" id="generateSchedule" disabled>Generate Schedule</button>
                <button class="btn-danger" id="clearAll">Clear All</button>
            </div>
        </div>

        <section class="tasks-panel">
            <h3>Your Tasks</h3>
            <div id="tasksList" class="tasks-list"></div>
        </section>

        <section class="schedule-section">
            <h3>This Week</h3>
            <div id="scheduleGrid" class="schedule-grid">
                <div class="day-column"><h4>Sun</h4><div id="sunEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Mon</h4><div id="monEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Tue</h4><div id="tueEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Wed</h4><div id="wedEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Thu</h4><div id="thuEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Fri</h4><div id="friEvents" class="event-container"></div></div>
                <div class="day-column"><h4>Sat</h4><div id="satEvents" class="event-container"></div></div>
            </div>
        </section>

        <section class="timeline-section">
            <h3>Generated Timeline</h3>
            <div id="timeline"><p class="empty-state">Tasks will appear here once you add them and generate the
                schedule.</p></div>
        </section>
    </main>
</div>

<!-- Modal for task details -->
<div id="taskModal" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <div id="modalBody"></div>
        <div class="modal-actions">
            <button id="updateTaskBtn" class="btn-primary">Update</button>
            <button id="deleteTaskBtn" class="btn-danger">Delete</button>
            <button id="closeModalBtn" class="btn-secondary">Close</button>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="footer">
    <div class="container">
        <p>&copy; 2026 ScheduleLynx. Your smart planner in sync.</p>
    </div>
</footer>

</body>
</html>

<script type="module" src="timetable-actions.js"></script>
<script type="module">

    import {
        setDefaultDate,
        setDefaultStartTime,
        setDefaultEndTime,
        reloadDataFromServer
    } from "./timetable-functions.js";

    // Webpage Initialization //////////////////////////////////////////////////

    setDefaultDate();
    setDefaultStartTime();
    setDefaultEndTime();
    reloadDataFromServer();


</script>